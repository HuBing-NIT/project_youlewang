"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.register=void 0;var _createClass=function(){function o(s,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(s,o.key,o)}}return function(s,e,n){return e&&o(s.prototype,e),n&&o(s,n),s}}(),_module_tool=require("./module_tool.js"),_module_sha=require("./module_sha1.js");function _classCallCheck(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}var register=function(){function s(){_classCallCheck(this,s),this.oInput=(0,_module_tool.$)(".item input","all"),this.oInp_res=(0,_module_tool.$)(".iteminput span","all"),this.yzm=(0,_module_tool.$)(".set_yzm"),this.pass=[!0,!0,!0,!0,!0,!1],this.oForm=(0,_module_tool.$)(".reg-form")}return _createClass(s,[{key:"init",value:function(){var n=this;this.yzm.innerHTML=(0,_module_tool.yzm)(),this.yzm.style.background="rgba("+(0,_module_tool.rannum)(0,255)+","+(0,_module_tool.rannum)(0,255)+","+(0,_module_tool.rannum)(0,255)+",0.5)";var e=this;this.oInput[0].onfocus=function(){""===this.value&&(e.oInp_res[0].className="tip wram",e.oInp_res[0].innerHTML="设置你的登录名",e.pass[0]=!1)},this.oInput[0].onblur=function(){""===this.value?(e.oInp_res[0].className="tip error",e.oInp_res[0].innerHTML="设置你的登录名",e.pass[0]=!1):(0,_module_tool.ajax)({type:"post",url:"../php/register.php",data:{username:this.value}}).then(function(s){console.log(s),s?(e.oInp_res[0].className="tip error",e.oInp_res[0].innerHTML="用户名已存在",e.pass[0]=!1):(e.oInp_res[0].className="tip success",e.oInp_res[0].innerHTML="",e.pass[0]=!0)})},this.oInput[1].onfocus=function(){""===this.value&&(e.oInp_res[1].className="tip wram",e.oInp_res[1].innerHTML="设置你的密码")},this.oInput[1].onblur=function(){""===this.value&&(e.oInp_res[1].className="tip error",e.oInp_res[1].innerHTML="密码不能为空",e.pass[1]=!1)},this.oInput[1].oninput=function(){e.pass_input()},this.oInput[2].onfocus=function(){""===this.value&&(e.oInp_res[2].innerHTML="请确认您刚输入的密码",e.oInp_res[2].className="tip wram",e.pass[2]=!1)},this.oInput[2].onblur=function(){""===this.value&&(e.oInp_res[2].innerHTML="请确认密码",e.oInp_res[2].className="tip error",e.pass[2]=!1)},this.oInput[2].oninput=function(){e.check_pass_input()},this.oInput[3].onfocus=function(){""===n.oInput[3].value&&(n.oInp_res[3].innerHTML="请输入邮箱",n.oInp_res[3].className="tip wram",n.pass[3]=!1)},this.oInput[3].onblur=function(){""!==n.oInput[3].value?/^(\w+[\+\-\_\.]*\w+)\@(\w+[\+\-\_\.]*\w+)\.(\w+[\+\-\_\.]*\w+)$/.test(n.oInput[3].value)?(n.oInp_res[3].className="tip success",n.oInp_res[3].innerHTML="",n.pass[3]=!0):(n.oInp_res[3].innerHTML="邮箱格式有问题",n.oInp_res[3].className="tip error",n.pass[3]=!1):(n.oInp_res[3].innerHTML="邮箱不能为空",n.oInp_res[3].className="tip error",n.pass[3]=!1)},this.yzm.onclick=function(){this.innerHTML=(0,_module_tool.yzm)(),this.style.background="rgba("+(0,_module_tool.rannum)(0,255)+","+(0,_module_tool.rannum)(0,255)+","+(0,_module_tool.rannum)(0,255)+",0.5)"},this.oInput[4].onfocus=function(){""===n.oInput[4].value&&(n.oInp_res[4].innerHTML="请输入验证码",n.oInp_res[4].className="tip error",n.pass[4]=!1)},this.oInput[4].onblur=function(){""!==n.oInput[4].value?n.yzm.innerHTML==n.oInput[4].value&&(n.oInp_res[4].className="tip success",n.oInp_res[4].innerHTML="",n.pass[4]=!0):(n.oInp_res[4].innerHTML="验证码不能为空",n.oInp_res[4].className="tip error",n.pass[4]=!1)},this.oInput[5].onclick=function(){this.checked?e.pass[5]=!0:e.pass[5]=!1},this.oForm.onsubmit=function(){""===n.oInput[0].value&&(n.oInp_res[0].innerHTML="用户名不能为空",n.oInp_res[0].className="tip error",n.pass[0]=!1),""===n.oInput[1].value&&(n.oInp_res[1].innerHTML="密码不能为空",n.oInp_res[1].className="tip error",n.pass[1]=!1),""===n.oInput[2].value&&(n.oInp_res[2].innerHTML="",n.pass[2]=!1),""===n.oInput[3].value&&(n.oInp_res[3].innerHTML="手机号码不能为空",n.oInp_res[3].className="tip error",n.pass[3]=!1),""===n.oInput[4].value&&(n.oInp_res[4].innerHTML="验证码不能为空",n.oInp_res[4].className="tip error",n.pass[4]=!1),n.pass[0]&&n.pass[1]&&n.pass[2]&&n.pass[3]&&n.pass[4]&&(n.pass[5]||window.alert("请查看并接收用户服务条款"));for(var s=1,e=0;e<n.pass.length;e++){if(-1!==n.pass.indexOf(!1))return!1;s=2;break}2==s&&alert("注册成功")}}},{key:"pass_input",value:function(){var s=this.oInput[1];if(6<=s.value.length&&s.value.length<=16){var e=/[\W\_]+/,n=0;switch(e.test(s.value)&&n++,/[0-9]+/.test(s.value)&&n++,/[a-z]+/.test(s.value)&&n++,e.test(s.value)&&n++,n){case 1:this.oInp_res[1].className="tip success",this.oInp_res[1].innerHTML="弱",this.oInp_res[1].style.color="red",this.pass[1]=!0;break;case 2:case 3:this.oInp_res[1].className="tip success",this.oInp_res[1].innerHTML="中",this.oInp_res[1].style.color="orange",this.pass[1]=!0;break;case 4:this.oInp_res[1].className="tip success",this.oInp_res[1].innerHTML="强",this.oInp_res[1].style.color="green",this.pass[1]=!0}}else this.oInp_res[1].innerHTML="密码长度为8-16位",this.oInp_res[1].className="tip error",this.pass[1]=!1}},{key:"check_pass_input",value:function(){""!==this.oInput[2].value?this.oInput[2].value==this.oInput[1].value?(this.oInp_res[2].className="tip success",this.oInp_res[2].innerHTML="",this.pass[2]=!0):(this.oInp_res[2].innerHTML="两次输入不相等",this.oInp_res[2].className="tip error",this.pass[2]=!1):(this.oInp_res[2].innerHTML="请确认您输入的密码",this.pass[2]=!1)}}]),s}();exports.register=register;